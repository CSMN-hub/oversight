<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oversight - Memecoin Intelligence Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-hover {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .pulse-green {
            animation: pulse-green 2s infinite;
        }
        @keyframes pulse-green {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .loading-spinner {
            border: 2px solid #f3f3f3;
            border-top: 2px solid #3498db;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 10px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">

    <!-- 
    NETLIFY DEPLOYMENT INSTRUCTIONS:
    
    1. Create a new folder for your project
    2. Save this HTML file as "index.html" in the root
    3. Create a "netlify/functions" folder
    4. Create a file "crypto-data.js" in netlify/functions with the function code below
    5. Deploy to Netlify (drag folder to netlify.app or connect to GitHub)
    
    SERVERLESS FUNCTION CODE (save as netlify/functions/crypto-data.js):
    
    const fetch = require('node-fetch');
    
    exports.handler = async (event, context) => {
        const headers = {
            'Access-Control-Allow-Origin': '*',
            'Access-Control-Allow-Headers': 'Content-Type',
            'Access-Control-Allow-Methods': 'GET, POST, OPTIONS'
        };
        
        if (event.httpMethod === 'OPTIONS') {
            return { statusCode: 200, headers, body: '' };
        }
        
        try {
            const { coin } = JSON.parse(event.body || '{}');
            
            // This would connect to Claude API with your MCP setup
            // Replace with your actual Claude API endpoint and key
            const claudeResponse = await fetch('https://api.anthropic.com/v1/messages', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${process.env.CLAUDE_API_KEY}`,
                    'anthropic-version': '2023-06-01'
                },
                body: JSON.stringify({
                    model: 'claude-3-sonnet-20240229',
                    max_tokens: 1000,
                    messages: [{
                        role: 'user',
                        content: `Get current ${coin} social sentiment, price, and social volume from LunarCrush MCP`
                    }]
                })
            });
            
            const data = await claudeResponse.json();
            
            // Parse Claude's response and format for dashboard
            // This is a simplified example - you'd parse the actual MCP data
            const mockData = {
                price: (Math.random() * 100).toFixed(4),
                sentiment: (Math.random() * 100).toFixed(1),
                socialVolume: Math.floor(Math.random() * 10000),
                change24h: ((Math.random() - 0.5) * 20).toFixed(2),
                news: [
                    {
                        title: `${coin} shows strong social momentum`,
                        source: 'CryptoSlate',
                        time: '2 hours ago',
                        url: 'https://cryptoslate.com'
                    }
                ]
            };
            
            return {
                statusCode: 200,
                headers,
                body: JSON.stringify(mockData)
            };
            
        } catch (error) {
            return {
                statusCode: 500,
                headers,
                body: JSON.stringify({ error: error.message })
            };
        }
    };
    
    ENVIRONMENT VARIABLES (set in Netlify dashboard):
    CLAUDE_API_KEY=your_claude_api_key_here
    -->

    <!-- Header -->
    <nav class="gradient-bg shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <i class="fas fa-chart-line text-2xl text-white mr-3"></i>
                    <h1 class="text-xl font-bold text-white">Oversight</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <button id="refreshAll" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-sync-alt mr-2"></i>Refresh All
                    </button>
                    <button id="aiChatBtn" class="bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-robot mr-2"></i>Ask Claude
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Dashboard -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- Overview Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
            <div class="bg-gray-800 rounded-lg p-6 card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-400 text-sm">Total Market Cap</p>
                        <p class="text-2xl font-bold text-green-400" id="totalMarketCap">Loading...</p>
                    </div>
                    <i class="fas fa-coins text-3xl text-green-400"></i>
                </div>
            </div>
            
            <div class="bg-gray-800 rounded-lg p-6 card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-400 text-sm">Avg Sentiment</p>
                        <p class="text-2xl font-bold text-blue-400" id="avgSentiment">Loading...</p>
                    </div>
                    <i class="fas fa-heart text-3xl text-blue-400"></i>
                </div>
            </div>
            
            <div class="bg-gray-800 rounded-lg p-6 card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-400 text-sm">Social Volume</p>
                        <p class="text-2xl font-bold text-purple-400" id="totalSocialVolume">Loading...</p>
                    </div>
                    <i class="fas fa-users text-3xl text-purple-400"></i>
                </div>
            </div>
        </div>

        <!-- Coin Tracking Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <!-- SPX6900 -->
            <div class="bg-gray-800 rounded-lg p-6 card-hover">
                <div class="flex justify-between items-center mb-4">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full flex items-center justify-center mr-3">
                            <span class="font-bold text-black">SPX</span>
                        </div>
                        <div>
                            <h3 class="text-lg font-bold">SPX6900</h3>
                            <p class="text-gray-400 text-sm">SPX</p>
                        </div>
                    </div>
                    <button onclick="refreshCoin('SPX6900')" class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm transition-colors">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
                
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <p class="text-gray-400 text-xs">Price</p>
                        <p class="text-xl font-bold text-green-400" id="spx-price">Loading...</p>
                        <p class="text-sm" id="spx-change">Loading...</p>
                    </div>
                    <div>
                        <p class="text-gray-400 text-xs">Sentiment</p>
                        <p class="text-xl font-bold text-blue-400" id="spx-sentiment">Loading...</p>
                        <p class="text-sm text-gray-400">Social Score</p>
                    </div>
                </div>
                
                <div class="mb-4">
                    <p class="text-gray-400 text-xs mb-2">Social Volume: <span id="spx-volume" class="text-white">Loading...</span></p>
                    <div class="bg-gray-700 rounded-full h-2">
                        <div class="bg-purple-500 h-2 rounded-full transition-all duration-500" id="spx-volume-bar" style="width: 0%"></div>
                    </div>
                </div>
                
                <div id="spx-news" class="space-y-2">
                    <p class="text-gray-400 text-sm">Loading news...</p>
                </div>
            </div>

            <!-- GIGA -->
            <div class="bg-gray-800 rounded-lg p-6 card-hover">
                <div class="flex justify-between items-center mb-4">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-r from-green-400 to-blue-500 rounded-full flex items-center justify-center mr-3">
                            <span class="font-bold text-white">G</span>
                        </div>
                        <div>
                            <h3 class="text-lg font-bold">GIGA</h3>
                            <p class="text-gray-400 text-sm">GIGA</p>
                        </div>
                    </div>
                    <button onclick="refreshCoin('GIGA')" class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm transition-colors">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
                
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <p class="text-gray-400 text-xs">Price</p>
                        <p class="text-xl font-bold text-green-400" id="giga-price">Loading...</p>
                        <p class="text-sm" id="giga-change">Loading...</p>
                    </div>
                    <div>
                        <p class="text-gray-400 text-xs">Sentiment</p>
                        <p class="text-xl font-bold text-blue-400" id="giga-sentiment">Loading...</p>
                        <p class="text-sm text-gray-400">Social Score</p>
                    </div>
                </div>
                
                <div class="mb-4">
                    <p class="text-gray-400 text-xs mb-2">Social Volume: <span id="giga-volume" class="text-white">Loading...</span></p>
                    <div class="bg-gray-700 rounded-full h-2">
                        <div class="bg-purple-500 h-2 rounded-full transition-all duration-500" id="giga-volume-bar" style="width: 0%"></div>
                    </div>
                </div>
                
                <div id="giga-news" class="space-y-2">
                    <p class="text-gray-400 text-sm">Loading news...</p>
                </div>
            </div>

            <!-- MOG -->
            <div class="bg-gray-800 rounded-lg p-6 card-hover">
                <div class="flex justify-between items-center mb-4">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-r from-pink-400 to-red-500 rounded-full flex items-center justify-center mr-3">
                            <span class="font-bold text-white">M</span>
                        </div>
                        <div>
                            <h3 class="text-lg font-bold">MOG</h3>
                            <p class="text-gray-400 text-sm">MOG</p>
                        </div>
                    </div>
                    <button onclick="refreshCoin('MOG')" class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm transition-colors">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
                
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <p class="text-gray-400 text-xs">Price</p>
                        <p class="text-xl font-bold text-green-400" id="mog-price">Loading...</p>
                        <p class="text-sm" id="mog-change">Loading...</p>
                    </div>
                    <div>
                        <p class="text-gray-400 text-xs">Sentiment</p>
                        <p class="text-xl font-bold text-blue-400" id="mog-sentiment">Loading...</p>
                        <p class="text-sm text-gray-400">Social Score</p>
                    </div>
                </div>
                
                <div class="mb-4">
                    <p class="text-gray-400 text-xs mb-2">Social Volume: <span id="mog-volume" class="text-white">Loading...</span></p>
                    <div class="bg-gray-700 rounded-full h-2">
                        <div class="bg-purple-500 h-2 rounded-full transition-all duration-500" id="mog-volume-bar" style="width: 0%"></div>
                    </div>
                </div>
                
                <div id="mog-news" class="space-y-2">
                    <p class="text-gray-400 text-sm">Loading news...</p>
                </div>
            </div>

            <!-- PUMP -->
            <div class="bg-gray-800 rounded-lg p-6 card-hover">
                <div class="flex justify-between items-center mb-4">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-r from-purple-400 to-pink-500 rounded-full flex items-center justify-center mr-3">
                            <span class="font-bold text-white">P</span>
                        </div>
                        <div>
                            <h3 class="text-lg font-bold">PUMP</h3>
                            <p class="text-gray-400 text-sm">PUMP</p>
                        </div>
                    </div>
                    <button onclick="refreshCoin('PUMP')" class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm transition-colors">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
                
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <p class="text-gray-400 text-xs">Price</p>
                        <p class="text-xl font-bold text-green-400" id="pump-price">Loading...</p>
                        <p class="text-sm" id="pump-change">Loading...</p>
                    </div>
                    <div>
                        <p class="text-gray-400 text-xs">Sentiment</p>
                        <p class="text-xl font-bold text-blue-400" id="pump-sentiment">Loading...</p>
                        <p class="text-sm text-gray-400">Social Score</p>
                    </div>
                </div>
                
                <div class="mb-4">
                    <p class="text-gray-400 text-xs mb-2">Social Volume: <span id="pump-volume" class="text-white">Loading...</span></p>
                    <div class="bg-gray-700 rounded-full h-2">
                        <div class="bg-purple-500 h-2 rounded-full transition-all duration-500" id="pump-volume-bar" style="width: 0%"></div>
                    </div>
                </div>
                
                <div id="pump-news" class="space-y-2">
                    <p class="text-gray-400 text-sm">Loading news...</p>
                </div>
            </div>

            <!-- DOGE -->
            <div class="bg-gray-800 rounded-lg p-6 card-hover">
                <div class="flex justify-between items-center mb-4">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-r from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center mr-3">
                            <span class="font-bold text-black">D</span>
                        </div>
                        <div>
                            <h3 class="text-lg font-bold">DOGE</h3>
                            <p class="text-gray-400 text-sm">DOGE</p>
                        </div>
                    </div>
                    <button onclick="refreshCoin('DOGE')" class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm transition-colors">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
                
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <p class="text-gray-400 text-xs">Price</p>
                        <p class="text-xl font-bold text-green-400" id="doge-price">Loading...</p>
                        <p class="text-sm" id="doge-change">Loading...</p>
                    </div>
                    <div>
                        <p class="text-gray-400 text-xs">Sentiment</p>
                        <p class="text-xl font-bold text-blue-400" id="doge-sentiment">Loading...</p>
                        <p class="text-sm text-gray-400">Social Score</p>
                    </div>
                </div>
                
                <div class="mb-4">
                    <p class="text-gray-400 text-xs mb-2">Social Volume: <span id="doge-volume" class="text-white">Loading...</span></p>
                    <div class="bg-gray-700 rounded-full h-2">
                        <div class="bg-purple-500 h-2 rounded-full transition-all duration-500" id="doge-volume-bar" style="width: 0%"></div>
                    </div>
                </div>
                
                <div id="doge-news" class="space-y-2">
                    <p class="text-gray-400 text-sm">Loading news...</p>
                </div>
            </div>

            <!-- PENGU -->
            <div class="bg-gray-800 rounded-lg p-6 card-hover">
                <div class="flex justify-between items-center mb-4">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-r from-blue-400 to-cyan-500 rounded-full flex items-center justify-center mr-3">
                            <span class="font-bold text-white">P</span>
                        </div>
                        <div>
                            <h3 class="text-lg font-bold">PENGU</h3>
                            <p class="text-gray-400 text-sm">PENGU</p>
                        </div>
                    </div>
                    <button onclick="refreshCoin('PENGU')" class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm transition-colors">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
                
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <p class="text-gray-400 text-xs">Price</p>
                        <p class="text-xl font-bold text-green-400" id="pengu-price">Loading...</p>
                        <p class="text-sm" id="pengu-change">Loading...</p>
                    </div>
                    <div>
                        <p class="text-gray-400 text-xs">Sentiment</p>
                        <p class="text-xl font-bold text-blue-400" id="pengu-sentiment">Loading...</p>
                        <p class="text-sm text-gray-400">Social Score</p>
                    </div>
                </div>
                
                <div class="mb-4">
                    <p class="text-gray-400 text-xs mb-2">Social Volume: <span id="pengu-volume" class="text-white">Loading...</span></p>
                    <div class="bg-gray-700 rounded-full h-2">
                        <div class="bg-purple-500 h-2 rounded-full transition-all duration-500" id="pengu-volume-bar" style="width: 0%"></div>
                    </div>
                </div>
                
                <div id="pengu-news" class="space-y-2">
                    <p class="text-gray-400 text-sm">Loading news...</p>
                </div>
            </div>
        </div>

        <!-- Chart Section -->
        <div class="bg-gray-800 rounded-lg p-6 mb-8">
            <h3 class="text-xl font-bold mb-4">Sentiment Comparison</h3>
            <div style="height: 400px;">
                <canvas id="sentimentChart"></canvas>
            </div>
        </div>
    </div>

    <!-- AI Chat Modal -->
    <div id="aiChatModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-gray-800 rounded-lg p-6 w-full max-w-2xl">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold">Ask Claude About Crypto</h3>
                    <button onclick="closeAIChat()" class="text-gray-400 hover:text-white">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div id="chatMessages" class="bg-gray-900 rounded-lg p-4 h-64 overflow-y-auto mb-4">
                    <p class="text-gray-400">Hi! I can help you analyze crypto sentiment and social data. Try asking:</p>
                    <ul class="text-sm text-blue-400 mt-2">
                        <li>• "What's DOGE sentiment today?"</li>
                        <li>• "Compare GIGA vs MOG social volume"</li>
                        <li>• "Which coin has the most buzz?"</li>
                    </ul>
                </div>
                
                <div class="flex">
                    <input type="text" id="chatInput" placeholder="Ask about crypto sentiment..." 
                           class="flex-1 bg-gray-700 text-white px-4 py-2 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <button onclick="sendChatMessage()" class="bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded-r-lg transition-colors">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center hidden z-40">
        <div class="bg-gray-800 rounded-lg p-8 text-center">
            <div class="loading-spinner"></div>
            <p class="text-white">Fetching latest crypto intelligence...</p>
        </div>
    </div>

    <script>
        // Configuration
        const COINS = ['SPX6900', 'GIGA', 'MOG', 'PUMP', 'DOGE', 'PENGU'];
        let sentimentChart = null;

        // Initialize Dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initializeChart();
            loadInitialData();
            
            // Set up refresh all button
            document.getElementById('refreshAll').addEventListener('click', refreshAllCoins);
            
            // Set up AI chat
            document.getElementById('aiChatBtn').addEventListener('click', openAIChat);
            document.getElementById('chatInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') sendChatMessage();
            });
        });

        // Initialize Chart
        function initializeChart() {
            const ctx = document.getElementById('sentimentChart').getContext('2d');
            sentimentChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: COINS,
                    datasets: [{
                        label: 'Sentiment Score',
                        data: [0, 0, 0, 0, 0, 0],
                        backgroundColor: 'rgba(59, 130, 246, 0.2)',
                        borderColor: 'rgb(59, 130, 246)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgb(59, 130, 246)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgb(59, 130, 246)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: { color: 'white' }
                        }
                    },
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(255, 255, 255, 0.1)' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            pointLabels: { color: 'white' },
                            ticks: { 
                                color: 'white',
                                backdropColor: 'transparent'
                            },
                            min: 0,
                            max: 100
                        }
                    }
                }
            });
        }

        // Load initial data for all coins
        function loadInitialData() {
            COINS.forEach(coin => {
                refreshCoin(coin, false);
            });
        }

        // Refresh single coin data
        async function refreshCoin(coin, showLoading = true) {
            if (showLoading) {
                showLoadingState(coin);
            }
            
            try {
                // Call Netlify function
                const response = await fetch('/.netlify/functions/crypto-data', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ coin: coin })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                updateCoinDisplay(coin, data);
                updateChart();
                
            } catch (error) {
                console.error(`Error fetching data for ${coin}:`, error);
                showErrorState(coin);
            }
        }

        // Update coin display with new data
        function updateCoinDisplay(coin, data) {
            const prefix = coin.toLowerCase();
            
            // Update price
            document.getElementById(`${prefix}-price`).textContent = `$${data.price}`;
            
            // Update change with color
            const changeElement = document.getElementById(`${prefix}-change`);
            const change = parseFloat(data.change24h);
            changeElement.textContent = `${change >= 0 ? '+' : ''}${change}%`;
            changeElement.className = change >= 0 ? 'text-sm text-green-400' : 'text-sm text-red-400';
            
            // Update sentiment
            document.getElementById(`${prefix}-sentiment`).textContent = `${data.sentiment}%`;
            
            // Update social volume
            document.getElementById(`${prefix}-volume`).textContent = data.socialVolume.toLocaleString();
            const volumeBar = document.getElementById(`${prefix}-volume-bar`);
            const volumePercent = Math.min((data.socialVolume / 10000) * 100, 100);
            volumeBar.style.width = `${volumePercent}%`;
            
            // Update news
            const newsContainer = document.getElementById(`${prefix}-news`);
            if (data.news && data.news.length > 0) {
                newsContainer.innerHTML = data.news.map(article => `
                    <div class="border-l-2 border-blue-500 pl-3 py-1">
                        <a href="${article.url}" target="_blank" class="text-blue-400 hover:text-blue-300 text-sm">
                            ${article.title}
                        </a>
                        <p class="text-xs text-gray-500">${article.source} • ${article.time}</p>
                    </div>
                `).join('');
            } else {
                newsContainer.innerHTML = '<p class="text-gray-400 text-sm">No recent news</p>';
            }
        }

        // Show loading state
        function showLoadingState(coin) {
            const prefix = coin.toLowerCase();
            document.getElementById(`${prefix}-price`).innerHTML = '<div class="loading-spinner"></div>';
            document.getElementById(`${prefix}-sentiment`).innerHTML = '<div class="loading-spinner"></div>';
        }

        // Show error state
        function showErrorState(coin) {
            const prefix = coin.toLowerCase();
            document.getElementById(`${prefix}-price`).textContent = 'Error';
            document.getElementById(`${prefix}-sentiment`).textContent = 'Error';
            document.getElementById(`${prefix}-volume`).textContent = 'Error';
        }

        // Refresh all coins
        async function refreshAllCoins() {
            document.getElementById('loadingOverlay').classList.remove('hidden');
            
            const promises = COINS.map(coin => refreshCoin(coin, false));
            await Promise.all(promises);
            
            updateOverviewStats();
            document.getElementById('loadingOverlay').classList.add('hidden');
        }

        // Update overview statistics
        function updateOverviewStats() {
            // Calculate total market cap, average sentiment, total social volume
            let totalMarketCap = 0;
            let totalSentiment = 0;
            let totalSocialVolume = 0;
            
            COINS.forEach(coin => {
                const prefix = coin.toLowerCase();
                const priceText = document.getElementById(`${prefix}-price`).textContent;
                const sentimentText = document.getElementById(`${prefix}-sentiment`).textContent;
                const volumeText = document.getElementById(`${prefix}-volume`).textContent;
                
                if (priceText !== 'Loading...' && priceText !== 'Error') {
                    const price = parseFloat(priceText.replace('$', ''));
                    totalMarketCap += price * 1000000; // Assume 1M supply for demo
                }
                
                if (sentimentText !== 'Loading...' && sentimentText !== 'Error') {
                    totalSentiment += parseFloat(sentimentText.replace('%', ''));
                }
                
                if (volumeText !== 'Loading...' && volumeText !== 'Error') {
                    totalSocialVolume += parseInt(volumeText.replace(/,/g, ''));
                }
            });
            
            document.getElementById('totalMarketCap').textContent = `$${(totalMarketCap / 1000000).toFixed(1)}M`;
            document.getElementById('avgSentiment').textContent = `${(totalSentiment / COINS.length).toFixed(1)}%`;
            document.getElementById('totalSocialVolume').textContent = totalSocialVolume.toLocaleString();
        }

        // Update radar chart
        function updateChart() {
            const sentimentData = COINS.map(coin => {
                const prefix = coin.toLowerCase();
                const sentimentText = document.getElementById(`${prefix}-sentiment`).textContent;
                return sentimentText !== 'Loading...' && sentimentText !== 'Error' ? 
                       parseFloat(sentimentText.replace('%', '')) : 0;
            });
            
            sentimentChart.data.datasets[0].data = sentimentData;
            sentimentChart.update();
        }

        // AI Chat Functions
        function openAIChat() {
            document.getElementById('aiChatModal').classList.remove('hidden');
        }

        function closeAIChat() {
            document.getElementById('aiChatModal').classList.add('hidden');
        }

        async function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            const chatMessages = document.getElementById('chatMessages');
            
            // Add user message
            chatMessages.innerHTML += `
                <div class="mb-3">
                    <div class="text-blue-400 text-sm">You:</div>
                    <div class="text-white">${message}</div>
                </div>
            `;
            
            input.value = '';
            
            // Add loading indicator
            chatMessages.innerHTML += `
                <div class="mb-3" id="aiResponse">
                    <div class="text-purple-400 text-sm">Claude:</div>
                    <div class="text-gray-300"><div class="loading-spinner"></div>Analyzing crypto data...</div>
                </div>
            `;
            
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            try {
                // This would call your Claude API through Netlify function
                // For now, we'll simulate a response
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                const aiResponse = `Based on the current social sentiment data, here's what I can tell you about ${message}...`;
                
                document.getElementById('aiResponse').innerHTML = `
                    <div class="text-purple-400 text-sm">Claude:</div>
                    <div class="text-white">${aiResponse}</div>
                `;
                
            } catch (error) {
                document.getElementById('aiResponse').innerHTML = `
                    <div class="text-purple-400 text-sm">Claude:</div>
                    <div class="text-red-400">Sorry, I'm having trouble accessing the latest data right now.</div>
                `;
            }
            
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Auto-refresh every 5 minutes
        setInterval(refreshAllCoins, 5 * 60 * 1000);
    </script>
</body>
</html>
